#!/usr/bin/env bash
set -euo pipefail

# this ensures that we are in the correct directory context
cd "$(dirname "$0")"/..

NEBULA_TASKS_REPO_BASE="${NEBULA_TASKS_REPO_BASE:-gcr.io/nebula-235818}"

docker build -f ./cmd/nebula-workflow-controller/Dockerfile -t "${NEBULA_TASKS_REPO_BASE}/nebula-workflow-controller:${VERSION}" .
docker build -f ./cmd/nebula-metadata-api/Dockerfile -t "${NEBULA_TASKS_REPO_BASE}/nebula-metadata-api:${VERSION}" .
docker build -f ./cmd/nebula-conditions/Dockerfile -t "${NEBULA_TASKS_REPO_BASE}/nebula-conditions:${VERSION}" .
